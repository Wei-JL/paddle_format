# 文件树文档

## 项目结构概览

本文档描述了paddle_format项目的完整目录结构、各模块功能边界、命名规范以及外置文件管理策略。

## 顶层目录结构

```
paddle_format/
├── .gitignore              # Git忽略文件配置
├── README.md               # 项目说明文档
├── requirements.txt        # Python依赖包列表
├── setup.py               # 项目安装配置
├── code/                  # 核心代码模块
│   ├── dataset_handler/   # 数据集处理模块
│   │   ├── __init__.py
│   │   ├── voc_dataset.py      # VOC数据集处理类
│   │   └── coco_dataset.py     # COCO数据集处理类
│   ├── global_var/        # 全局变量和配置
│   │   ├── __init__.py
│   │   └── global_cls.py       # 全局常量定义
│   ├── logger_code/       # 日志系统
│   │   └── logger_sys.py       # 通用日志系统
│   ├── logs/              # 代码模块日志
│   │   ├── app.log
│   │   └── log_out_*.log       # 时间戳日志文件
│   ├── test_*.py          # 测试脚本
│   └── 测试报告.md         # 测试结果报告
├── dataset/               # 数据集存储目录
│   ├── Fruit.zip          # 压缩的示例数据集
│   └── Fruit/             # 解压后的VOC格式数据集
│       ├── Annotations/        # XML标注文件
│       ├── Annotations_*/      # 过滤后的标注文件
│       ├── JPEGImages/         # 图像文件
│       ├── ImageSets/Main/     # 数据集划分文件
│       ├── *_coco.json         # COCO格式转换文件
│       └── labels.txt          # 类别标签文件
├── docs/                  # 项目文档
│   ├── 使用指南.md         # 用户使用指南
│   ├── 文件树文档.md       # 本文档
│   └── 测试报告.md         # 功能测试报告
└── logs/                  # 全局日志目录
    ├── app.log
    └── paddle_format_*.log     # 项目级日志文件
```

## 模块边界定义

### 1. code/ - 核心代码模块
- **职责**: 包含所有可执行的Python代码
- **边界**: 不包含数据文件、配置文件或文档
- **依赖**: 可以访问dataset/和logs/目录
- **子模块**:
  - `dataset_handler/`: 数据集处理核心功能
  - `global_var/`: 项目级配置和常量
  - `logger_code/`: 通用日志系统
  - `logs/`: 模块级日志输出

### 2. dataset_handler/ - 数据集处理模块
- **职责**: VOC/COCO格式数据集的处理、转换、验证
- **边界**: 专注于数据集操作，不处理模型训练
- **接口**: 提供统一的数据集处理API
- **核心文件**:
  - `voc_dataset.py`: VOC数据集完整处理流程
  - `coco_dataset.py`: COCO数据集处理（预留）

### 3. global_var/ - 全局变量模块
- **职责**: 存储项目级别的常量、配置和宏定义
- **边界**: 只包含配置，不包含业务逻辑
- **使用方式**: 通过import导入到其他模块

### 4. logger_code/ - 日志系统模块
- **职责**: 提供统一的日志记录功能
- **特性**: 支持文件轮转、时间戳、多级别日志
- **复用性**: 可复制到其他项目使用

### 5. dataset/ - 数据集存储模块
- **职责**: 存储原始数据集和处理后的数据
- **结构**: 支持多个数据集并存
- **格式**: 标准VOC目录结构
- **生成文件**: COCO转换文件、划分文件、标签文件

### 6. docs/ - 文档模块
- **职责**: 项目文档和说明
- **内容**: 使用指南、API文档、测试报告
- **维护**: 与代码功能同步更新

## 命名规范

### 文件命名
- **Python模块**: 小写+下划线 (`voc_dataset.py`)
- **类名**: 大驼峰命名 (`VOCDataset`)
- **函数名**: 小写+下划线 (`extract_classes_only`)
- **常量**: 大写+下划线 (`TRAIN_RATIO`)
- **日志文件**: 时间戳格式 (`log_out_20250826_151357.log`)

### 目录命名
- **代码目录**: 小写+下划线 (`dataset_handler`)
- **数据目录**: 首字母大写 (`Annotations`, `JPEGImages`)
- **文档目录**: 小写 (`docs`)

### 变量命名
- **实例变量**: 小写+下划线 (`valid_pairs`)
- **私有方法**: 下划线开头 (`_validate_basic_structure`)
- **临时变量**: 简短描述性名称 (`img_path`, `xml_file`)

## 外置大文件挂载策略

### 数据集文件管理
```
dataset/
├── [dataset_name]/        # 具体数据集目录
│   ├── Annotations/       # 标注文件 (通常<100MB)
│   ├── JPEGImages/        # 图像文件 (可能>1GB)
│   └── ImageSets/         # 划分文件 (<1MB)
├── [dataset_name].zip     # 压缩包 (便于分发)
└── external_datasets/     # 外部大数据集软链接
```

### 大文件处理建议
1. **图像数据集** (>1GB): 
   - 使用软链接指向外部存储
   - 或使用云存储挂载点
   
2. **预训练模型** (>100MB):
   - 存储在独立的models/目录
   - 不纳入版本控制
   
3. **日志文件** (累积>100MB):
   - 自动轮转和压缩
   - 定期清理旧日志

### 版本控制策略
- **包含**: 代码、文档、小型示例数据
- **排除**: 大型数据集、日志文件、临时文件
- **LFS管理**: 中等大小的二进制文件 (10MB-100MB)

## 扩展性设计

### 新数据集格式支持
```
code/dataset_handler/
├── voc_dataset.py         # 现有VOC支持
├── coco_dataset.py        # COCO格式支持
├── yolo_dataset.py        # 未来YOLO格式支持
└── custom_dataset.py      # 自定义格式支持
```

### 新功能模块添加
```
code/
├── dataset_handler/       # 数据处理
├── model_handler/         # 模型处理 (未来)
├── training_utils/        # 训练工具 (未来)
└── evaluation_tools/      # 评估工具 (未来)
```

### 配置文件扩展
```
config/
├── dataset_config.yaml    # 数据集配置
├── model_config.yaml      # 模型配置
└── training_config.yaml   # 训练配置
```

## 依赖关系图

```
docs/ ←── README.md
  ↑
code/
├── dataset_handler/ ←── global_var/
│   ↓                    ↑
├── logger_code/ ←───────┘
│   ↓
└── logs/
    ↓
logs/ (全局日志)
    ↓
dataset/ (数据存储)
```

## 维护指南

### 日常维护
1. **日志清理**: 定期清理超过30天的日志文件
2. **测试更新**: 新功能添加后更新测试用例
3. **文档同步**: 代码变更后及时更新文档

### 版本发布
1. **功能测试**: 运行完整测试套件
2. **文档更新**: 更新使用指南和API文档
3. **依赖检查**: 确认requirements.txt准确性

### 性能监控
1. **处理速度**: 监控大数据集处理性能
2. **内存使用**: 避免内存泄漏
3. **磁盘空间**: 监控日志和临时文件占用